<% provide(:title, 'Forum') %>

<div class="page-header">
  <h3>Рубрики</h3>
</div>



<div class="panel panel-default">
  <!-- Default panel contents -->
  <div class="panel-heading">Panel heading</div>

    <table class="table">
      <thread>
          <tr>
            <th width="10%"></th>
            <th width="40%">Forum</th>
            <th width="10%">Topics</th>
            <th width="10%">Comments</th>
            <th width="30%">Last Comment</th>
          </tr>
      </thread>

      <% for rubric in @rubrics %>

      <tbody>
            <tr>
              <td></td>

              <td><p><%= link_to h(rubric.name), rubric_path(rubric.id) %></p>
              <%=h rubric.body %></td>

              <td><%= rubric.topics.count %></td>

              <td><%= rubric.comments.count %></td>

              <td>
                <% if rubric.comments.any? %>
                  <% comments = rubric.comments %>

                  <%= link_to comments.last.topic.name, comments.last.topic %><br>
                  <%= distance_of_time_in_words_to_now comments.last.created_at %> ago by <%= comments.last.user.name %>

                <% elsif %>
                  <% if rubric.topics.any? %>
                    <%= link_to rubric.topics.last.name, rubric.topics.last %><br>
                    <p>This topic has no comments</p>
                  <% end %>
                <% else %>
                  <p>Empty</p>
                <% end %>
              </td>

            </tr>
      </tbody>

      <% end %>
    </table>
</div>
